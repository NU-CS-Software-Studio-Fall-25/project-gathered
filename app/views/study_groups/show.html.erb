<div class="container">
  <%= link_to "← Back to #{@study_group.course.course_name}", course_path(@study_group.course), class: "back-link" %>
  
  <div id="flash_messages" class="flash-container"></div>

  <div class="study-group-detail">
    <div class="detail-header">
      <h1><%= @study_group.topic %></h1>
      <span class="status-badge large <%= @study_group.status %>"><%= @study_group.status.titleize %></span>
    </div>

    <div class="detail-body">
      <div class="info-section">
        <h3>Details</h3>
        
        <div class="info-grid">
          <div class="info-item">
            <span class="icon">📚</span>
            <div>
              <strong>Course</strong>
              <p><%= @study_group.course.course_name %></p>
            </div>
          </div>

          <div class="info-item">
            <span class="icon">📅</span>
            <div>
              <strong>Time</strong>
              <p><%= @study_group.formatted_time_range %></p>
            </div>
          </div>

          <% if @study_group.location.present? %>
            <div class="info-item">
              <span class="icon">📍</span>
              <div>
                <strong>Location</strong>
                <p><%= @study_group.location %></p>
              </div>
            </div>
          <% end %>

          <div class="info-item">
            <span class="icon">👤</span>
            <div>
              <strong>Created by</strong>
              <p><%= @study_group.creator.name %></p>
            </div>
          </div>

          <% if @study_group.duration_minutes %>
            <div class="info-item">
              <span class="icon">⏱️</span>
              <div>
                <strong>Duration</strong>
                <p><%= @study_group.duration_minutes %> minutes</p>
              </div>
            </div>
          <% end %>
        </div>

        <% if @study_group.description.present? %>
          <div class="description">
            <strong>Description</strong>
            <p><%= @study_group.description %></p>
          </div>
        <% end %>
      </div>

      <div class="members-section">
        <h3>Members (<%= @members.count %>)</h3>
        
        <div class="members-list">
          <% @members.each do |member| %>
            <div class="member-card">
              <span class="member-avatar"><%= member.name[0].upcase %></span>
              <span class="member-name"><%= member.name %></span>
              <% if member.student_id == @study_group.creator_id %>
                <span class="creator-badge">Creator</span>
              <% end %>
            </div>
          <% end %>
        </div>

        <% if @members.empty? %>
          <p class="empty-state">No members yet. Be the first to join!</p>
        <% end %>
      </div>
    </div>

    <div class="detail-actions">
      <%= button_to "Join Group", 
                    join_study_group_path(@study_group, student_id: Student.first&.student_id),
                    method: :post,
                    class: "btn btn-primary",
                    data: { turbo_stream: true },
                    disabled: @study_group.status == "past" %>
      <%= link_to "Back to Course", course_path(@study_group.course), class: "btn btn-secondary" %>
    </div>
  </div>
</div>

