<div id="study_group_actions" class="flex flex-wrap items-center justify-between gap-3">
  <div class="flex items-center gap-3">
    <% student_id = defined?(current_student_id) ? current_student_id : (current_student&.student_id) %>
    <% if student_id && study_group.member_ids.include?(student_id) %>
      <%= button_to leave_study_group_path(study_group, student_id: student_id),
                    method: :delete,
                    class: "cursor-pointer inline-flex items-center gap-2 rounded-md border border-white/20 bg-white/5 px-4 py-2 text-sm font-medium text-slate-200 hover:bg-red-500/20 hover:border-red-400/30 hover:text-red-200 transition",
                    data: { turbo_stream: true } do %>
        <svg class="w-4 h-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
        </svg>
        <span>Leave Group</span>
      <% end %>
    <% else %>
      <%= button_to join_study_group_path(study_group, student_id: student_id),
                    method: :post,
                    class: "cursor-pointer inline-flex items-center gap-2 rounded-md bg-violet-600/90 px-4 py-2 text-sm font-semibold text-white shadow-md hover:bg-violet-500/90 transition #{ study_group.status == 'past' ? 'opacity-50 cursor-not-allowed' : '' }",
                    data: { turbo_stream: true },
                    disabled: study_group.status == "past" do %>
        <svg class="w-4 h-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
        </svg>
        <span>Join Group</span>
      <% end %>
    <% end %>
  </div>

  <div class="flex items-center gap-3">
    <%= link_to export_ics_study_group_path(study_group, format: :ics),
                class: "inline-flex items-center gap-2 rounded-md border border-white/20 px-4 py-2 text-sm text-slate-200 hover:bg-white/5 transition",
                data: { turbo: false } do %>
      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M12 3a1 1 0 011 1v9.586l2.293-2.293a1 1 0 011.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L11 13.586V4a1 1 0 011-1z"/>
        <path d="M5 18a1 1 0 011-1h12a1 1 0 110 2H6a1 1 0 01-1-1z"/>
      </svg>
      <span>Export</span>
    <% end %>

    <%= link_to "javascript:history.back()", class: "inline-flex items-center gap-2 rounded-md border border-white/20 px-4 py-2 text-sm text-slate-200 hover:bg-white/5 transition" do %>
      <svg class="w-4 h-4" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/>
      </svg>
      <span>Back</span>
    <% end %>
  </div>
</div>
